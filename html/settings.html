<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="Content-Security-Policy" />
        <meta
            http-equiv="X-Content-Security-Policy"
            content="default-src 'self'; script-src 'self'"
        />
        <title>Rechnung</title>
        <link rel="stylesheet" href="../style/index.css" />
    </head>
    <body>
        <form action="">
            <label for="logo">Logo</label>
            <input type="file" accept="image/png" id="logo" name="logo" />
            <label for="name">Unternehmensbezeichnung</label>
            <input type="text" id="name" name="name" />
            <label for="street">Stra√üe</label>
            <input type="text" id="street" name="street" />
            <label for="zip">PLZ u. Ort</label>
            <input type="text" id="zip" name="zip" />
            <label for="tel">Telefon</label>
            <input type="text" id="tel" name="tel" />
            <label for="mail">E-Mail</label>
            <input type="text" id="mail" name="mail" />
            <label for="iban">IBAN</label>
            <input type="text" id="iban" name="iban" />
            <label for="bic">BIC</label>
            <input type="text" id="bic" name="bic" />
            <label for="Kontoinhaber">Kontoinhaber</label>
            <input type="text" id="Kontoinhaber" name="Kontoinhaber" />
            <label for="bank">Bank</label>
            <input type="text" id="bank" name="bank" />
            <label for="kleinunternehmer">Kleinunternehmerregelung</label>
            <input
                type="checkbox"
                id="kleinunternehmer"
                name="kleinunternehmer"
            />
            <input type="submit" value="Speichern" />
        </form>
        <script>
            window.$ = window.jQuery = require("jquery");
            const fs = require("fs");
            $("form").submit((e) => {
                e.preventDefault();
                var data = $("form :input").serializeArray();
                logoPath = $("#logo")[0].files[0].path;
                fs.copyFileSync(logoPath, "resources/logo.png");
                let companyInfoObject = {};
                for (i of data) {
                    companyInfoObject[i.name] = i.value
                }
                companyInfoObject["kleinunternehmer"] = $("#kleinunternehmer")[0].value=="on" ? true : false
                const companyInfoJson = JSON.stringify(companyInfoObject);

                fs.writeFileSync("resources/companyInfo.json", companyInfoJson)
                window.location.href = "index.html";
            });
        </script>
    </body>
</html>
